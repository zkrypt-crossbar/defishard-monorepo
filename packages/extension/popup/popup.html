<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DeFiShArd Wallet</title>
    <link rel="stylesheet" href="popup.css">
</head>
<body>
    <div class="defishard-popup">
        <!-- Header -->
        <div class="header">
            <div class="logo-section">
                <img src="../assets/icons/icon.svg" alt="DeFiShArd" class="logo">
                <div class="title-section">
                    <h1 class="title">DeFiShArd</h1>
                    <p class="subtitle">Secure MPC Wallet</p>
                </div>
            </div>
            <div class="status-indicator">
                <span class="status-dot" id="connection-status"></span>
                <span class="status-text" id="status-text">Disconnected</span>
            </div>
        </div>

        <!-- Main Content Area -->
        <div class="main-content" id="main-content">
            <!-- Welcome Screen -->
            <div class="screen" id="welcome-screen">
                <div class="welcome-content">
                    <div class="welcome-icon">
                        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 2L2 7l10 5 10-5-10-5z" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
                            <path d="M2 17l10 5 10-5" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
                            <path d="M2 12l10 5 10-5" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
                        </svg>
                    </div>
                    <h2 class="welcome-title">Welcome to DeFiShArd</h2>
                    <p class="welcome-description">
                        Create a secure distributed wallet using Multi-Party Computation (MPC) technology.
                    </p>
                    <div class="wallet-info">
                        <div class="info-item">
                            <span class="info-icon">üîê</span>
                            <span class="info-text">No single point of failure</span>
                        </div>
                        <div class="info-item">
                            <span class="info-icon">‚ö°</span>
                            <span class="info-text">Instant threshold signing</span>
                        </div>
                        <div class="info-item">
                            <span class="info-icon">üõ°Ô∏è</span>
                            <span class="info-text">Military-grade security</span>
                        </div>
                    </div>
                    <button class="primary-btn create-wallet-btn" id="create-wallet-btn">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 5v14M5 12h14" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
                        </svg>
                        Create DeFiShArd Wallet
                    </button>
                </div>
            </div>

            <!-- Wallet Creation Screen -->
            <div class="screen hidden" id="wallet-creation-screen">
                <div class="creation-content">
                    <div class="step-indicator">
                        <div class="step active" data-step="1">
                            <span class="step-number">1</span>
                            <span class="step-label">Configure</span>
                        </div>
                        <div class="step-line"></div>
                        <div class="step" data-step="2">
                            <span class="step-number">2</span>
                            <span class="step-label">Share</span>
                        </div>
                        <div class="step-line"></div>
                        <div class="step" data-step="3">
                            <span class="step-number">3</span>
                            <span class="step-label">Generate</span>
                        </div>
                    </div>

                    <!-- Step 1: Wallet Configuration -->
                    <div class="step-content" id="step-1-content">
                        <h3 class="step-title">Configure Your Wallet</h3>
                        <p class="step-description">
                            Set up your distributed wallet configuration. You'll need at least 2 devices to complete the setup.
                        </p>
                        
                        <div class="form-group">
                            <label for="wallet-name" class="form-label">Wallet Name</label>
                            <input 
                                type="text" 
                                id="wallet-name" 
                                class="form-input" 
                                placeholder="Enter wallet name (e.g., My DeFi Wallet)"
                                maxlength="50"
                            >
                            <div class="form-help">Choose a memorable name for your wallet</div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="threshold" class="form-label">Threshold</label>
                                <select id="threshold" class="form-select">
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                </select>
                                <div class="form-help">Minimum parties needed to sign</div>
                            </div>
                            <div class="form-group">
                                <label for="total-parties" class="form-label">Total Parties</label>
                                <select id="total-parties" class="form-select">
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                </select>
                                <div class="form-help">Total number of devices</div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="wallet-password" class="form-label">Wallet Password (Optional)</label>
                            <input 
                                type="password" 
                                id="wallet-password" 
                                class="form-input" 
                                placeholder="Enter password to encrypt keyshare"
                            >
                            <div class="form-help">Add extra security to your keyshare</div>
                        </div>

                        <div class="wallet-preview">
                            <h4>Wallet Configuration Preview</h4>
                            <div class="preview-item">
                                <span class="preview-label">Name:</span>
                                <span class="preview-value" id="preview-name">-</span>
                            </div>
                            <div class="preview-item">
                                <span class="preview-label">Security:</span>
                                <span class="preview-value" id="preview-security">2-of-2</span>
                            </div>
                            <div class="preview-item">
                                <span class="preview-label">Encryption:</span>
                                <span class="preview-value" id="preview-encryption">None</span>
                            </div>
                        </div>

                        <div class="step-actions">
                            <button class="secondary-btn" id="back-to-welcome">Back</button>
                            <button class="primary-btn" id="next-to-share" disabled>
                                Next: Share QR Code
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M5 12h14M12 5l7 7-7 7" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
                                </svg>
                            </button>
                        </div>
                    </div>

                    <!-- Step 2: QR Code Sharing -->
                    <div class="step-content hidden" id="step-2-content">
                        <h3 class="step-title">Share with Other Devices</h3>
                        <p class="step-description">
                            Scan this QR code with other devices to join the wallet creation process.
                        </p>
                        
                        <div class="qr-section">
                            <div class="qr-container" id="qr-container">
                                <div class="qr-placeholder">
                                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M3 3h6v6H3zM15 3h6v6h-6zM3 15h6v6H3zM15 15h6v6h-6z" stroke="currentColor" strokeWidth="2"/>
                                    </svg>
                                    <p>Creating group and generating QR code...</p>
                                </div>
                            </div>
                            
                            <div class="qr-info">
                                <div class="info-card">
                                    <h4>Instructions</h4>
                                    <ol class="instruction-list">
                                        <li>Open DeFiShArd app on another device</li>
                                        <li>Tap "Join Wallet" or "Scan QR Code"</li>
                                        <li>Scan this QR code</li>
                                        <li>Wait for all devices to connect</li>
                                    </ol>
                                </div>
                                
                                <div class="connection-status-card">
                                    <h4>Connection Status</h4>
                                    <div class="connection-list" id="connection-list">
                                        <div class="connection-item">
                                            <span class="connection-dot connected"></span>
                                            <span class="connection-text">This device (Creator)</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="step-actions">
                            <button class="secondary-btn" id="back-to-config">Back</button>
                            <button class="primary-btn" id="start-keygen" disabled>
                                <span class="btn-text">Start Key Generation</span>
                                <span class="btn-loading hidden">
                                    <svg class="loading-spinner" width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
                                    </svg>
                                    Starting...
                                </span>
                            </button>
                        </div>
                    </div>

                    <!-- Step 3: Key Generation -->
                    <div class="step-content hidden" id="step-3-content">
                        <h3 class="step-title">Generating Your Wallet</h3>
                        <p class="step-description">
                            Creating your distributed keys across all connected devices. This process is secure and cannot be interrupted.
                        </p>
                        
                        <div class="keygen-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" id="progress-fill"></div>
                            </div>
                            <div class="progress-text" id="progress-text">Initializing...</div>
                        </div>

                        <div class="keygen-status">
                            <div class="status-item" id="status-round">
                                <span class="status-icon">üîÑ</span>
                                <span class="status-text">Round 0/4: Initializing</span>
                            </div>
                            <div class="status-item" id="status-connections">
                                <span class="status-icon">üîó</span>
                                <span class="status-text">2/2 devices connected</span>
                            </div>
                            <div class="status-item" id="status-security">
                                <span class="status-icon">üõ°Ô∏è</span>
                                <span class="status-text">Verifying cryptographic operations</span>
                            </div>
                        </div>

                        <div class="keygen-timer">
                            <span class="timer-label">Estimated time remaining:</span>
                            <span class="timer-value" id="timer-value">--:--</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Wallet Created Success Screen -->
            <div class="screen hidden" id="success-screen">
                <div class="success-content">
                    <div class="success-icon">
                        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M20 6L9 17l-5-5" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
                        </svg>
                    </div>
                    <h2 class="success-title">Wallet Created Successfully!</h2>
                    <p class="success-description">
                        Your DeFiShArd wallet is ready to use. The keys are securely distributed across your devices.
                    </p>
                    
                    <div class="wallet-summary">
                        <div class="summary-item">
                            <span class="summary-label">Wallet Name:</span>
                            <span class="summary-value" id="final-wallet-name">-</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Security Level:</span>
                            <span class="summary-value" id="final-security-level">-</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Public Key:</span>
                            <span class="summary-value" id="final-public-key">-</span>
                        </div>
                    </div>

                    <div class="success-actions">
                        <button class="primary-btn" id="view-wallet-btn">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" stroke="currentColor" strokeWidth="2"/>
                                <circle cx="12" cy="12" r="3" stroke="currentColor" strokeWidth="2"/>
                            </svg>
                            View Wallet
                        </button>
                        <button class="secondary-btn" id="create-another-btn">
                            Create Another Wallet
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <div class="footer-links">
                <button class="footer-link" id="settings-btn">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6z" stroke="currentColor" strokeWidth="2"/>
                        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z" stroke="currentColor" strokeWidth="2"/>
                    </svg>
                    Settings
                </button>
                <button class="footer-link" id="help-btn">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="2"/>
                        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
                        <line x1="12" y1="17" x2="12.01" y2="17" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
                    </svg>
                    Help
                </button>
            </div>
        </div>
    </div>

    <script src="popup.js"></script>
</body>
</html>
